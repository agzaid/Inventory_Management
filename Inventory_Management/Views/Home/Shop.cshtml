@model Domain.Models.PortalVM

<style>
    .category-scroll {
        display: flex;
        overflow-x: auto;
        gap: 12px;
        padding: 12px 5px;
        scrollbar-width: none; /* hide scrollbar (Firefox) */
        -ms-overflow-style: none; /* hide scrollbar (IE) */
    }

        .category-scroll::-webkit-scrollbar {
            display: none; /* hide scrollbar (Chrome/Safari) */
        }

    .category-pill {
        flex: 0 0 auto;
        padding: 12px 22px;
        border-radius: 50px;
        background: #fff;
        font-size: 14px;
        font-weight: 500;
        color: #444;
        border: 1px solid #e5e7eb;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        transition: all 0.25s ease;
        cursor: pointer;
        white-space: nowrap;
    }

        .category-pill:hover {
            transform: translateY(-2px) scale(1.03);
            background: #28a745;
            color: #fff;
            border-color: #28a745;
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .category-pill.active {
            background: #28a745;
            color: #fff;
            border-color: #28a745;
            box-shadow: 0 4px 10px rgba(40, 167, 69, 0.25);
        }

    .brand-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 10px;
        transition: all 0.3s ease;
    }

    .brand-box {
        flex: 0 0 auto;
        background-color: #fff;
        border: 1px solid #e5e7eb;
        border-radius: 10px;
        padding: 10px 15px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        cursor: pointer;
        transition: all 0.25s ease;
    }

        .brand-box:hover {
            background-color: #28a745;
            color: white;
            transform: translateY(-2px);
        }

        .brand-box.active {
            background-color: #28a745;
            color: white;
        }
</style>
<div class="container mt-3">
    <div class="row d-flex justify-content-center">
        <div class="col-md-8">
            <div class="fm-search">
                <div class="mb-0">
                    <div class="input-group input-group-lg">
                        <span class="input-group-text bg-transparent" id="porductSearch" style="cursor:pointer"><i class="fa-solid fa-magnifying-glass"></i></span>
                        <input id="inputSearch" type="text" class="form-control" placeholder="@Localizer["Searchproducts"]">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<h5 class="mt-5 text-center">@Localizer["WelcomeToOurShop"]</h5>

<section id="feature" class="section-p1">
    <!-- Category Scroll -->
    <div class="category-scroll">
        <div class="category-pill active" data-category-id="all">
            <h6>@Localizer["AllProducts"]</h6>
        </div>
        @foreach (var category in Model.CategoryVMs)
        {
            <div class="category-pill" data-category-id="@category.Id">
                <h6>@category.DisplayCategoryName</h6>
            </div>
        }
    </div>

    <!-- Brand Container (dynamic) -->
    <div id="brand-container" class="brand-container mt-3">
        <p class="placeholder-text text-muted">@Localizer["SelectCategoryToViewBrands"]</p>
    </div>
</section>


<section id="product1" class="section-p1">
    <h2>@Localizer["FeaturedProducts"]</h2>
    @* <p>Summer Collection New Modern Design</p> *@
    <div id="products-container">
        <div class="pro-container">
            <div class="row row-cols-2 row-cols-sm-3 row-cols-md-4 row-cols-lg-5 row-cols-xl-6 g-3" id="pro-container">
                <partial name="_ProductListPartial" model="Model.ProductVMs" />
            </div>
        </div>
    </div>
</section>
<section id="banner" style="height:0px" class="section-m1">
    <button class="normal" style="cursor:pointer;background-color: #088178; color: #fff;" id="exploreMore">
        @Localizer["ExploreMore"]
    </button>
</section>
@* 
<section id="banner" class="section-m1">
    <h4>Repair Services</h4>
    <h2>Up to <span>70% off</span> - All t-Shirts & Accessories</h2>
    <button class="normal">Expore More</button>
</section>

<section id="product1" class="section-p1">
    <h2>New Arrivals</h2>
    <p>Summer Collection New Modern Design</p>
    <div class="pro-container">
        <div class="pro">
            <img src="img/products/n1.jpg" alt="">
            <div class="des">
                <span>adidas</span>
                <h5>Cartoon Astronaut T-Shirts</h5>
                <div class="star">
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                </div>
                <h4>$78</h4>
            </div>
            <a href="#"><i class="ri-shopping-cart-2-line cart"></i></a>
        </div>
        <div class="pro">
            <img src="img/products/n2.jpg" alt="">
            <div class="des">
                <span>adidas</span>
                <h5>Cartoon Astronaut T-Shiirts</h5>
                <div class="star">
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                </div>
                <h4>$78</h4>
            </div>
            <a href="#"><i class="ri-shopping-cart-2-line cart"></i></a>
        </div>
        <div class="pro">
            <img src="img/products/n3.jpg" alt="">
            <div class="des">
                <span>adidas</span>
                <h5>Cartoon Astronaut T-Shiirts</h5>
                <div class="star">
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                </div>
                <h4>$78</h4>
            </div>
            <a href="#"><i class="ri-shopping-cart-2-line cart"></i></a>
        </div>
        <div class="pro">
            <img src="img/products/n4.jpg" alt="">
            <div class="des">
                <span>adidas</span>
                <h5>Cartoon Astronaut T-Shiirts</h5>
                <div class="star">
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                </div>
                <h4>$78</h4>
            </div>
            <a href="#"><i class="ri-shopping-cart-2-line cart"></i></a>
        </div>
        <div class="pro">
            <img src="img/products/n5.jpg" alt="">
            <div class="des">
                <span>adidas</span>
                <h5>Cartoon Astronaut T-Shiirts</h5>
                <div class="star">
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                </div>
                <h4>$78</h4>
            </div>
            <a href="#"><i class="ri-shopping-cart-2-line cart"></i></a>
        </div>
        <div class="pro">
            <img src="img/products/n6.jpg" alt="">
            <div class="des">
                <span>adidas</span>
                <h5>Cartoon Astronaut T-Shiirts</h5>
                <div class="star">
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                </div>
                <h4>$78</h4>
            </div>
            <a href="#"><i class="ri-shopping-cart-2-line cart"></i></a>
        </div>
        <div class="pro">
            <img src="img/products/n7.jpg" alt="">
            <div class="des">
                <span>adidas</span>
                <h5>Cartoon Astronaut T-Shiirts</h5>
                <div class="star">
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                </div>
                <h4>$78</h4>
            </div>
            <a href="#"><i class="ri-shopping-cart-2-line cart"></i></a>
        </div>
        <div class="pro">
            <img src="img/products/n8.jpg" alt="">
            <div class="des">
                <span>adidas</span>
                <h5>Cartoon Astronaut T-Shiirts</h5>
                <div class="star">
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                    <i class="ri-star-fill"></i>
                </div>
                <h4>$78</h4>
            </div>
            <a href="#"><i class="ri-shopping-cart-2-line cart"></i></a>
        </div>
    </div>
</section>

<section id="sm-banner" class="section-p1">
    <div class="banner-box">
        <h4>crazy deals</h4>
        <h2>buy 1 get 1 free</h2>
        <span>The best classic dress is on sale at cara</span>
        <button class="white">Learn More</button>
    </div>
    <div class="banner-box banner-box2">
        <h4>spring/summer</h4>
        <h2>upcoming season</h2>
        <span>The best classic dress is on sale at cara</span>
        <button class="white">Collection</button>
    </div>
</section>

<section id="banner3">
    <div class="banner-box">
        <h2>SEASONAL SALE</h2>
        <h3>Winter Collection -50% OFF</h3>
    </div>
    <div class="banner-box banner-box2">
        <h2>NEW FOOTWEAR COLLECTION</h2>
        <h3>Spring / Summer 2024</h3>
    </div>
    <div class="banner-box banner-box3">
        <h2>T-SHIRTS</h2>
        <h3>New Trendy Prints</h3>
    </div>
</section>

<section id="newsletter" class="section-p1 section-m1">
    <div class="newstext">
        <h4>Sign Up For Newsletters</h4>
        <p>Get E-mail updates about our latest shop and <span>special offers.</span></p>
    </div>
    <div class="form">
        <input type="text" placeholder="Your email address">
        <button class="normal">Sign Up</button>
    </div>
</section> *@
@section scripts {
    <script>
        //
        $(document).ready(function() {
            var pageNumber = 2;
            var pageSize = 20;
            var selectedCategoryId = null;

             var cart = JSON.parse(localStorage.getItem('cart')) || [];
             if(cart == [] || $("#cartNum").length==0){
                 var cartt = $("#cartNum").length;
                 $("#cartNum,#cartNum1")[0].innerHTML= 0;
             }else{
                 $("#cartNum,#cartNum1")[0].innerHTML= cart.length;
             }


                  $('.category-dropdown').on('click', function () {
                      selectedCategoryId = $(this).data('value') || null; // save it

                      var url = '@Url.Action("GetProductsByCategory", "Home")';
                      Search(selectedCategoryId,url);
             });

                  $('#inputSearch').on('input', function () {
                      debugger;
                      var query = $(this).val();
                      if (query.length > 2) {
                       var url = '@Url.Action("GetProductsByName", "Home")';
                      SearchProduct(query,url);
                      }
                 });
                 $('#exploreMore').on('click', function () {
                          debugger;
                             var $url = "@Url.Action("GetPaginatedProducts", "Home")";
                             var parameter = {
                                 pageNumber: pageNumber,
                                 pageSize: pageSize,
                                 categoryId: selectedCategoryId // send current category

                             };
                             $('#loader').show();
                             _Ajax.ReturnHTML($url, parameter, "GET", function () { },
                                 function (data) {
                                    $('#loader').hide();
                                     pageNumber++;
                                     $('#pro-container').append(data);
                                 },
                                 function (xhr) {
                                    $('#loader').hide();
                                     _SWAL.AlertWithoutNotification("Something went wrong..!!");
                                 });
                         });

          $('.category-pill').on('click', function () {
                  $('.category-pill').removeClass('active');
                  $(this).addClass('active');

                  var categoryId = $(this).data('category-id');
                  selectedCategoryId = categoryId === "all" ? null : categoryId;

                  // Load products
                  var url = '@Url.Action("GetProductsByCategory", "Home")';
                  Search(selectedCategoryId, url);

                  // Show brands for this category
                  $('#brand-container').empty();

                  if (categoryId === "all") {
                      $('#brand-container').html('<p class="text-muted">@Localizer["SelectCategoryToViewBrands"]</p>');
                      return;
                  }

                  var category = @Html.Raw(Json.Serialize(Model.CategoryVMs));
                  var selected = category.find(c => c.id === categoryId);

                  if (selected && selected.brandVMs && selected.brandVMs.length > 0) {
                      selected.brandVMs.forEach(function (brand) {
                          $('#brand-container').append(`
                              <div class="brand-box" data-brand-id="${brand.id}">
                                  ${brand.displayBrandName}
                              </div>
                          `);
                      });
                  } else {
                      $('#brand-container').html('<p class="text-muted">@Localizer["NoBrandsFoundForCategory"]</p>');
                  }
        });
                // Brand click → filter products
        $(document).on('click', '.brand-box', function () {
            $('.brand-box').removeClass('active');
            $(this).addClass('active');

            var brandId = $(this).data('brand-id');
            var url = '@Url.Action("GetProductsByBrand", "Home")';
            var parameter = { brandId: brandId };

            $('#loader').show();
            _Ajax.ReturnHTML(url, parameter, "GET", function () { },
                function (data) {
                    $('#loader').hide();
                    $('#pro-container').html(data);
                },
                function () {
                    $('#loader').hide();
                    _SWAL.AlertWithoutNotification("@Localizer["SomethingWentWrong"]");
                });
        });








             });
             function Search(inputSearch, url){
                 debugger;
                 var $url = url;
                 var parameter = {
                     categoryId: inputSearch
                 };
                 $('#loader').show();

                 _Ajax.ReturnHTML($url, parameter, "GET", function () { },
                     function (data) {
                         $('#loader').hide();
                         $('#pro-container').html(data);
                     },
                     function (xhr) {
                         $('#loader').hide();
                         _SWAL.AlertWithoutNotification("@Localizer["SomethingWentWrong"]");
                         // _SWAL.AlertWithoutNotification(`@Html.Raw(Localizer["SomethingWentWrong"])`);
                     });
             };
             function SearchProduct(inputSearch, url){
                 debugger;
                 var $url = url;
                 var parameter = {
                     name: inputSearch
                 };
                 $('#loader').show();

                 _Ajax.ReturnHTML($url, parameter, "GET", function () { },
                     function (data) {
                         $('#loader').hide();
                         $('#pro-container').html(data);
                     },
                     function (xhr) {
                       $('#loader').hide();
                         _SWAL.AlertWithoutNotification("Something went wrong..!!");
                     });
                    };
    </script>
}